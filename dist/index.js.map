{"version":3,"file":"index.js","sources":["../src/scriptLoader.tsx","../src/index.tsx"],"sourcesContent":["import {useState, useEffect} from 'react'\n\nconst loadScript = (src: string, id: string, callback: Function) => {\n    const existingScript = document.getElementById(id);\n\n    if(!existingScript) {\n        const script = document.createElement('script')\n\n        script.src = src\n        script.id = id\n    \n        document.body.appendChild(script)\n    \n        script.onload = () => {\n            if(callback) callback()\n        }\n\n        if(existingScript && callback) callback()\n    }\n}\n\nexport interface Options {\n    callback: Function,\n    removeScript: Boolean\n}\n\n\n\nconst useScript:Function = async (src: string, id: string = 'injected-script', options: Options = {callback: () => null, removeScript: true} ) => {\n    const [isScriptLoaded, setScriptLoaded] = useState(false);\n    const {callback, removeScript} = options;\n\n    await useEffect(()=>{\n        if(!isScriptLoaded){\n            loadScript(src, id, callback)\n            setScriptLoaded(true)\n        }\n        return () => {\n            if(removeScript) {\n                const existingScript = document.getElementById(id);\n                if(existingScript) existingScript.remove()\n            }\n        }\n    },[src])\n    return true\n}\n\nexport default useScript","import * as React from 'react'\nimport useScript, {Options} from './scriptLoader'\nimport './styles.scss'\n\nconst {useState, useEffect, useRef, Fragment } = React;\n\nconst KAKAO_API: string = 'https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js'\n\n\nexport type RKakaoPostcodeProps = {\n    className?: string,\n    onChange: Function,\n    scriptId: string,\n    options: Options,\n}\n\nconst ReactKakaoPostcode: React.FC<RKakaoPostcodeProps> = ({className, onChange, scriptId = 'kakao-script', options = {removeScript: true,}}) =>  {\n    useScript(KAKAO_API, scriptId, options)\n\n    const postcodeArea: any = useRef(null);\n\n    const [data, setData] = useState(null)\n\n    useEffect(()=>{\n        if(!onChange) return\n        onChange(data)\n    }, [data])\n    \n    function exec_map() {\n        const currentScroll = Math.max(document.body.scrollTop, document.documentElement.scrollTop)\n        \n        const daumObj: any = window[\"daum\"]\n\n        new daumObj.Postcode({\n            oncomplete: function(data: any) {\n                setData(data)\n                closeMap()\n                document.body.scrollTop = currentScroll\n            },\n            onresize: function(size: any) {\n                postcodeArea.current.style.height = size.height + 'px'\n              \n            },\n            width: '100%',\n            height: '100%',\n            animation: true,\n        }).embed(postcodeArea.current)\n\n        postcodeArea.current.style.display = 'block'\n    }\n    \n    const openMap = () => {\n        if(!window[\"daum\"]) {\n            alert('다음 우편번호 서비스에 문제가 있습니다. 다시 시도해 주세요.')\n            return\n        }\n        exec_map()\n    }\n\n    const closeMap = () => {\n        postcodeArea.current.style.display = 'none'\n    } \n\n    return (\n        <Fragment>\n            <div className={className}>Test Purpose is updated</div>\n            <div ref={postcodeArea} />\n            <button onClick={openMap}>open</button>\n            <button onClick={closeMap}>close</button>\n        </Fragment>\n\n    )\n}\n\nexport default ReactKakaoPostcode"],"names":["useState","useEffect","React.useState","React.useEffect","React.useRef","React.Fragment","React.createElement"],"mappings":"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"}